---
title: "Edge Processing for Splunk Environments"
description: "Reduce Splunk indexing costs by 60-80% with edge data processing"
tags: [splunk, edge-processing, log-management, cost-optimization]
---

# Edge Processing for Splunk Environments

## The Problem: Splunk Costs Are Out of Control

If you're a Splunk administrator, this scenario sounds familiar:

- **Your indexing costs are skyrocketing** — Splunk charges $150-250 per GB indexed daily
- **60-80% of your log data is noise** — DEBUG messages, health checks, duplicate events
- **Heavy Forwarders are expensive to maintain** — require dedicated infrastructure and ongoing management
- **Data travels to indexers before any filtering happens** — you pay to process noise

**The math is brutal:** A typical enterprise with 1TB/day ingestion pays ~$200 × 1,000GB = **$200,000/day** to index data, where 700GB is noise. That's **$51M/year** wasted on indexing garbage.

## The Solution: Process Data AT THE SOURCE

Expanso Edge acts like an intelligent **Heavy Forwarder** that sits between your data sources and Splunk indexers. Instead of sending everything to Splunk and filtering later, Expanso:

✅ **Filters noise before it reaches Splunk** — drop DEBUG/TRACE, dedupe events, sample verbose sources  
✅ **Parses and enriches at the edge** — field extraction, normalization, metadata tagging  
✅ **Routes intelligently** — send security events to `security` index, metrics to `metrics`, etc.  
✅ **Reduces indexing volume by 60-80%** — only critical data reaches your indexers  

## Architecture: Expanso + Splunk Integration

<div style={{display: 'flex', gap: '2rem', flexWrap: 'wrap', margin: '2rem 0'}}>

<div style={{flex: '1', minWidth: '280px', padding: '1.5rem', borderRadius: '12px', border: '1px solid var(--ifm-color-emphasis-300)', background: 'var(--ifm-background-surface-color)'}}>
<div style={{fontSize: '0.75rem', fontWeight: 600, textTransform: 'uppercase', letterSpacing: '0.05em', color: 'var(--ifm-color-danger)', marginBottom: '1rem'}}>❌ Traditional Splunk</div>
<div style={{display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '0.5rem'}}>
<div style={{padding: '0.6rem 1.5rem', borderRadius: '8px', background: 'var(--ifm-color-emphasis-200)', fontWeight: 500, textAlign: 'center', width: '100%'}}>Log Sources</div>
<div style={{fontSize: '1.2rem'}}>↓</div>
<div style={{padding: '0.6rem 1.5rem', borderRadius: '8px', background: 'var(--ifm-color-emphasis-200)', fontWeight: 500, textAlign: 'center', width: '100%'}}>Heavy Forwarder</div>
<div style={{fontSize: '0.7rem', color: 'var(--ifm-font-color-secondary)'}}>no filtering</div>
<div style={{fontSize: '1.2rem'}}>↓ 100% of data</div>
<div style={{padding: '0.6rem 1.5rem', borderRadius: '8px', background: '#dc2626', color: 'white', fontWeight: 600, textAlign: 'center', width: '100%'}}>Splunk Indexers</div>
<div style={{fontSize: '0.7rem', color: 'var(--ifm-color-danger)'}}>$200K/day</div>
<div style={{fontSize: '1.2rem'}}>↓</div>
<div style={{padding: '0.6rem 1.5rem', borderRadius: '8px', background: 'var(--ifm-color-emphasis-200)', fontWeight: 500, textAlign: 'center', width: '100%'}}>Expensive Storage</div>
</div>
</div>

<div style={{flex: '1', minWidth: '280px', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--ifm-color-primary)', background: 'var(--ifm-background-surface-color)'}}>
<div style={{fontSize: '0.75rem', fontWeight: 600, textTransform: 'uppercase', letterSpacing: '0.05em', color: 'var(--ifm-color-primary)', marginBottom: '1rem'}}>✅ With Expanso Edge</div>
<div style={{display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '0.5rem'}}>
<div style={{padding: '0.6rem 1.5rem', borderRadius: '8px', background: 'var(--ifm-color-emphasis-200)', fontWeight: 500, textAlign: 'center', width: '100%'}}>Log Sources</div>
<div style={{fontSize: '1.2rem'}}>↓</div>
<div style={{padding: '0.75rem 1.5rem', borderRadius: '8px', background: 'var(--ifm-color-primary)', color: 'white', fontWeight: 600, textAlign: 'center', width: '100%', boxShadow: '0 2px 8px rgba(107,70,193,0.3)'}}>Expanso Edge</div>
<div style={{fontSize: '0.7rem', color: 'var(--ifm-color-primary)'}}>filter, parse, enrich, route</div>
<div style={{display: 'flex', gap: '1rem', width: '100%', justifyContent: 'center'}}>
<div style={{display: 'flex', flexDirection: 'column', alignItems: 'center', flex: 1}}>
<div style={{fontSize: '1rem'}}>↓ 30%</div>
<div style={{padding: '0.5rem 0.75rem', borderRadius: '8px', background: '#16a34a', color: 'white', fontWeight: 600, textAlign: 'center', width: '100%', fontSize: '0.85rem'}}>Splunk HEC</div>
<div style={{fontSize: '1rem'}}>↓</div>
<div style={{padding: '0.5rem 0.75rem', borderRadius: '8px', background: 'var(--ifm-color-emphasis-200)', fontWeight: 500, textAlign: 'center', width: '100%', fontSize: '0.85rem'}}>Indexers</div>
<div style={{fontSize: '0.7rem', color: '#16a34a'}}>$60K/day</div>
</div>
<div style={{display: 'flex', flexDirection: 'column', alignItems: 'center', flex: 1}}>
<div style={{fontSize: '1rem'}}>↓ 70%</div>
<div style={{padding: '0.5rem 0.75rem', borderRadius: '8px', background: 'var(--ifm-color-emphasis-200)', fontWeight: 500, textAlign: 'center', width: '100%', fontSize: '0.85rem'}}>S3 / Archive</div>
<div style={{fontSize: '0.7rem', color: 'var(--ifm-font-color-secondary)'}}>cold storage</div>
</div>
</div>
</div>
</div>

</div>

**Key Benefits:**
- **Cost Reduction:** $200K/day → $60K/day (70% savings)
- **Better Performance:** Less data = faster searches
- **Compliance Ready:** PII masking before it enters Splunk
- **Multi-Destination:** Send to Splunk + S3 + metrics systems simultaneously

## If You Know Splunk, You Already Know Expanso

Expanso uses familiar Splunk concepts with more powerful capabilities:

| **Splunk Concept** | **Expanso Equivalent** | **Enhancement** |
|---|---|---|
| `inputs.conf` | Pipeline `input` section | Real-time parsing, multiformat support |
| `props.conf` / `transforms.conf` | Pipeline `processors` + Bloblang | Side-by-side SPL translations |
| `outputs.conf` | Pipeline `output` section | Multi-destination routing |
| Heavy Forwarder | Expanso Edge Node | Lightweight, cloud-managed |
| SPL field extraction | Bloblang mapping | More expressive, reusable |
| Deployment Server | Expanso Cloud Console | GitOps-driven, instant rollouts |

## What You'll Build

In this tutorial, you'll create a complete Splunk integration that:

1. **Collects logs like inputs.conf** — file monitoring, multiline parsing
2. **Parses data like props.conf** — field extraction, normalization  
3. **Filters before indexing** — the game-changer Splunk can't do natively
4. **Routes to Splunk HEC** — proper index/sourcetype tagging
5. **Advanced patterns** — multi-destination, compliance, metrics

## Prerequisites

- Expanso Edge installed ([installation guide](https://docs.expanso.io/edge/install))
- Splunk instance with HEC token configured
- Basic familiarity with Splunk configuration files

## Get Started

Choose your path:

### [Interactive Explorer](./explorer)
See each Splunk integration technique with side-by-side transformations

### [Step-by-Step Tutorial](./setup)
Build the pipeline incrementally:
1. [Collect Like inputs.conf](./step-1-collect-like-inputs-conf)
2. [Parse Like props.conf](./step-2-parse-like-props-conf)
3. [Filter Before Indexing](./step-3-filter-before-indexing)
4. [Route to Splunk HEC](./step-4-route-to-splunk-hec)
5. [Advanced Splunk Patterns](./step-5-advanced-splunk-patterns)

### [Complete Pipeline](./complete-splunk-integration)
Download the production-ready solution

---

*Expanso makes your Splunk investment go further. This isn't about replacing Splunk — it's about making it more efficient, cost-effective, and powerful.*
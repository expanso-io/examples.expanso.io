---
title: Complete PII Removal Pipeline
sidebar_label: Complete Pipeline
sidebar_position: 9
description: The complete 5-step PII removal pipeline for GDPR/PCI-DSS compliance
keywords: [complete, pii-removal, gdpr, pci-dss]
---

import CodeBlock from '@theme/CodeBlock';
import pipelineYaml from '!!raw-loader!../../../examples/data-security/remove-pii-complete.yaml';
import CopyPipelineButton from '@site/src/components/CopyPipelineButton';

# Complete Pipeline

<CopyPipelineButton pipeline={pipelineYaml} />

This pipeline combines all 5 PII removal techniques from this tutorial:

1. **Delete payment data** - Remove card numbers, CVV, expiry (PCI-DSS)
2. **Hash IP addresses** - SHA-256 hash for abuse detection without tracking
3. **Hash emails** - Hash email, extract domain for org analytics
4. **Pseudonymize names** - Create consistent user_id without identity
5. **Generalize location** - Remove GPS, keep city/state/country

**Result:** GDPR + PCI-DSS compliant data with 90% analytics value preserved.

## Full Configuration

<CodeBlock language="yaml" title="remove-pii.yaml">{pipelineYaml}</CodeBlock>

## Quick Test

```bash
# Send event with PII
curl -X POST http://localhost:8080/events \
  -H "Content-Type: application/json" \
  -d '{
    "event_id": "evt_001",
    "user_name": "Sarah Johnson",
    "email": "sarah.johnson@example.com",
    "ip_address": "192.168.1.100",
    "payment_method": {
      "full_number": "4532-1234-5678-9010",
      "expiry": "12/25"
    },
    "location": {
      "latitude": 37.7749,
      "longitude": -122.4194,
      "city": "San Francisco",
      "state": "California"
    }
  }'

# Output:
# - payment_method.full_number → deleted (last_four preserved)
# - ip_address → "sha256:a1b2c3..."
# - email → "sha256:d4e5f6...", email_domain: "example.com"
# - user_name → deleted, user_id: "usr_abc123"
# - latitude/longitude → deleted (city/state preserved)
```

## Deploy

```bash
# Deploy to Expanso orchestrator
expanso-cli job deploy remove-pii.yaml

# Or run locally with expanso-edge
expanso-edge run --config remove-pii.yaml
```

## Download

<a href="/examples/data-security/remove-pii-complete.yaml" download className="button button--primary">
  Download remove-pii.yaml
</a>

## What's Next?

- [Troubleshooting](./troubleshooting) - Common issues and solutions
- [Encrypt Data](../encrypt-data/) - Encrypt instead of delete

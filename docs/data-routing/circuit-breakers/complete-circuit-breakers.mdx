---
title: Complete Circuit Breakers Pipeline
sidebar_label: Complete Pipeline
sidebar_position: 7
description: The complete circuit breakers pipeline with multi-level fallback
keywords: [complete, circuit-breakers, fallback, resilience]
---

import CodeBlock from '@theme/CodeBlock';
import pipelineYaml from '!!raw-loader!../../../examples/data-routing/step-3-multi-level-fallback.yaml';
import CopyPipelineButton from '@site/src/components/CopyPipelineButton';

# Complete Pipeline

<CopyPipelineButton pipeline={pipelineYaml} />

This pipeline combines all circuit breaker techniques from this tutorial:

- **Multi-level fallback** - Primary API → Secondary API → Local buffer → DLQ
- **Automatic recovery** - Retries with backoff at each level
- **No data loss** - Failed requests always land somewhere recoverable

## Full Configuration

<CodeBlock language="yaml" title="circuit-breakers.yaml">{pipelineYaml}</CodeBlock>

## Quick Test

```bash
# Test with primary API available
curl -X POST http://localhost:8080/events \
  -H "Content-Type: application/json" \
  -d '{"event": "test", "data": "hello"}'

# Simulate primary failure - request falls through fallback chain
# Check /var/buffer/failed-requests.jsonl for locally buffered data
```

## Deploy

```bash
# Deploy to Expanso orchestrator
expanso-cli job deploy circuit-breakers.yaml

# Or run locally with expanso-edge
expanso-edge run --config circuit-breakers.yaml
```

## Download

<a href="/examples/data-routing/step-3-multi-level-fallback.yaml" download className="button button--primary">
  Download circuit-breakers.yaml
</a>

## What's Next?

- [Troubleshooting](./troubleshooting) - Common issues and solutions
- [Priority Queues](../priority-queues/) - Route by priority level

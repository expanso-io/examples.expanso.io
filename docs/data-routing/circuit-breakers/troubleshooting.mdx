---
title: Troubleshooting
sidebar_label: Troubleshooting
sidebar_position: 8
description: Common circuit breaker issues and solutions
keywords: [troubleshooting, debug, circuit-breakers, fallback]
---

# Troubleshooting

## Quick Diagnosis

```bash
# Check container status
docker ps | grep circuit-breakers

# Check recent logs
docker logs circuit-breakers --tail 50 2>&1 | grep -i error

# Check fallback buffer (if using file fallback)
ls -la /var/buffer/failed-requests.jsonl 2>/dev/null || echo "No buffer file"
```

## Common Issues

### Circuit breaker not triggering

**Cause:** Threshold not reached or timeout too long

```bash
# Check logs for retry attempts
docker logs circuit-breakers --tail 50 2>&1 | grep -i retry
```

**Fix:** Lower the failure threshold or reduce timeout:
```yaml
max_retries: 3
timeout: 5s  # Reduce from 30s
```

---

### All requests going to fallback

**Cause:** Primary destination down or unreachable

```bash
# Test primary destination directly
curl -s -o /dev/null -w "%{http_code}" $PRIMARY_API_URL/health
```

**Fix:** Verify destination URL, check network, restart destination service

---

### Fallback buffer filling up

**Cause:** Primary has been down too long, buffer not being replayed

```bash
# Check buffer size
wc -l /var/buffer/failed-requests.jsonl 2>/dev/null
```

**Fix:** Fix primary destination, then replay the buffer manually or restart the pipeline

---

### Data loss during failover

**Cause:** No fallback configured or fallback also failing

**Fix:** Add multi-level fallback chain:
```yaml
output:
  fallback:
    - http_client: {url: "${PRIMARY_URL}"}
    - http_client: {url: "${SECONDARY_URL}"}
    - file: {path: "/var/buffer/emergency.jsonl"}
```

## Still stuck?

1. Add debug logging: `logger: {level: DEBUG}`
2. Check the [Complete Pipeline](./complete-circuit-breakers) for reference config
3. Review [Priority Queues](../priority-queues/) for handling degraded service

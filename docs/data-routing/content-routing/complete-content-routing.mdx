---
title: Complete Content Routing Pipeline
sidebar_label: Complete Pipeline
sidebar_position: 8
description: The complete content routing pipeline combining all techniques from this tutorial
keywords: [complete, content-routing, severity, production]
---

import CodeBlock from '@theme/CodeBlock';
import pipelineYaml from '!!raw-loader!../../../examples/data-routing/content-routing.yaml';
import CopyPipelineButton from '@site/src/components/CopyPipelineButton';

# Complete Pipeline

<CopyPipelineButton pipeline={pipelineYaml} />

This pipeline combines all the content routing techniques from this tutorial:

- **Severity routing** - CRITICAL → PagerDuty, WARN → Slack, INFO → Elasticsearch
- **Input validation** - Ensures required fields exist
- **Metadata enrichment** - Adds routing timestamps and node ID

## Full Configuration

<CodeBlock language="yaml" title="content-routing.yaml">{pipelineYaml}</CodeBlock>

## Quick Test

```bash
# Test critical alert (goes to PagerDuty)
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -d '{"severity": "CRITICAL", "message": "Database connection lost"}'

# Test warning (goes to Slack)
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -d '{"severity": "WARN", "message": "High memory usage"}'

# Test info (goes to Elasticsearch)
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -d '{"severity": "INFO", "message": "User logged in"}'
```

## Deploy

```bash
# Deploy to Expanso orchestrator
expanso-cli job deploy content-routing.yaml

# Or run locally with expanso-edge
expanso-edge run --config content-routing.yaml
```

## Download

<a href="/examples/data-routing/content-routing.yaml" download className="button button--primary">
  Download content-routing.yaml
</a>

## What's Next?

- [Troubleshooting](./troubleshooting) - Common issues and solutions
- [Circuit Breakers](../circuit-breakers/) - Add fault tolerance to your pipeline

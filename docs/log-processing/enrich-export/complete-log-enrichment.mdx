---
title: Complete Log Enrichment Pipeline
sidebar_label: Complete Pipeline
sidebar_position: 9
description: The complete log enrichment and S3 export pipeline
keywords: [complete, log-enrichment, s3-export, metadata]
---

import CodeBlock from '@theme/CodeBlock';
import pipelineYaml from '!!raw-loader!../../../examples/log-processing/enrich-export-complete.yaml';

# Complete Pipeline

This pipeline combines all log enrichment techniques from this tutorial:

- **Data lineage** - Add source tracking and audit trail metadata
- **Restructured output** - Clean event/metadata separation for analytics
- **Intelligent batching** - Time and size-based batching for S3
- **Compressed storage** - Gzip compression for cost-effective archival

## Full Configuration

<CodeBlock language="yaml" title="enrich-export.yaml">{pipelineYaml}</CodeBlock>

## Quick Test

```bash
# Send log events
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -d '{
    "level": "INFO",
    "message": "User logged in",
    "user_id": "123",
    "service": "auth"
  }'

# Events enriched with lineage metadata and batched to S3
# Check s3://your-bucket/logs/YYYY/MM/DD/ for output
```

## Deploy

```bash
# Deploy to Expanso orchestrator
expanso-cli job deploy enrich-export.yaml

# Or run locally with expanso-edge
expanso-edge run --config enrich-export.yaml
```

## Download

<a href="/examples/log-processing/enrich-export-complete.yaml" download className="button button--primary">
  Download enrich-export.yaml
</a>

## What's Next?

- [Troubleshooting](./troubleshooting) - Common issues and solutions
- [Filter Severity](../filter-severity/) - Route logs by severity level

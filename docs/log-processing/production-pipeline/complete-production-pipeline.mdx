---
title: Complete Production Log Processing Pipeline
sidebar_label: Complete Pipeline
sidebar_position: 10
description: The complete production-ready log processing pipeline
keywords: [complete, production, log-processing, pipeline]
---

import CodeBlock from '@theme/CodeBlock';
import pipelineYaml from '!!raw-loader!../../../examples/log-processing/production-pipeline-complete.yaml';
import CopyPipelineButton from '@site/src/components/CopyPipelineButton';

# Complete Pipeline

<CopyPipelineButton pipeline={pipelineYaml} />

This pipeline combines all production log processing techniques:

- **HTTP input** - Secure endpoint with rate limiting
- **Validation** - JSON schema validation with DLQ routing
- **Enrichment** - Add metadata, lineage, and audit trail
- **Filtering** - Severity-based routing and cost optimization
- **PII redaction** - Remove sensitive data for compliance
- **Fan-out routing** - Send to Elasticsearch, S3, and backup

## Full Configuration

<CodeBlock language="yaml" title="production-pipeline.yaml">{pipelineYaml}</CodeBlock>

## Quick Test

```bash
# Send a production log event
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $API_TOKEN" \
  -d '{
    "level": "ERROR",
    "message": "Payment failed for user john.doe@example.com",
    "service": "payment",
    "trace_id": "abc123",
    "user_ip": "192.168.1.100"
  }'

# Log is:
# - Validated against schema
# - Enriched with metadata
# - PII (email, IP) redacted
# - Routed to Elasticsearch + S3 based on severity
```

## Deploy

```bash
# Deploy to Expanso orchestrator
expanso-cli job deploy production-pipeline.yaml

# Or run locally with expanso-edge
expanso-edge run --config production-pipeline.yaml
```

## Download

<a href="/examples/log-processing/production-pipeline-complete.yaml" download className="button button--primary">
  Download production-pipeline.yaml
</a>

## What's Next?

- [Troubleshooting](./troubleshooting) - Common issues and solutions
- [Content Routing](../../data-routing/content-routing/) - Route data by content

---
title: Complete Log Severity Filtering Pipeline
sidebar_label: Complete Pipeline
sidebar_position: 6
description: The complete log filtering and severity routing pipeline
keywords: [complete, log-filtering, severity, routing]
---

import CodeBlock from '@theme/CodeBlock';
import pipelineYaml from '!!raw-loader!../../../examples/log-processing/filter-severity-complete.yaml';

# Complete Pipeline

This pipeline combines all log filtering techniques from this tutorial:

- **JSON parsing with fallback** - Handle mixed JSON and plain text logs
- **Severity classification** - Map log levels to CRITICAL/HIGH/MEDIUM/LOW
- **Conditional routing** - Route by severity to different destinations
- **Drop low-value logs** - Filter DEBUG/TRACE to reduce storage costs

## Full Configuration

<CodeBlock language="yaml" title="filter-severity.yaml">{pipelineYaml}</CodeBlock>

## Quick Test

```bash
# Send critical log (routes to alerting)
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -d '{"level": "ERROR", "message": "Database connection failed"}'

# Send info log (routes to storage)
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -d '{"level": "INFO", "message": "User logged in"}'

# Send debug log (dropped)
curl -X POST http://localhost:8080/logs \
  -H "Content-Type: application/json" \
  -d '{"level": "DEBUG", "message": "Processing request"}'
```

## Deploy

```bash
# Deploy to Expanso orchestrator
expanso-cli job deploy filter-severity.yaml

# Or run locally with expanso-edge
expanso-edge run --config filter-severity.yaml
```

## Download

<a href="/examples/log-processing/filter-severity-complete.yaml" download className="button button--primary">
  Download filter-severity.yaml
</a>

## What's Next?

- [Troubleshooting](./troubleshooting) - Common issues and solutions
- [Enrich & Export](../enrich-export/) - Add metadata and export to S3
